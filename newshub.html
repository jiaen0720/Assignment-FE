<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">

    <!-- Animation -->
    <link rel="stylesheet" href="./assets/css/aos.css">

    <!-- Font-Awesome -->
    <link rel="stylesheet" href="./assets/css/all.min.css">

    <!-- Initialization -->
    <link rel="stylesheet" href="./assets/css/initialization.css">

    <!-- Layout -->
    <link rel="stylesheet" href="./assets/css/layout.css">

    <!-- Custom -->
    <link rel="stylesheet" href="./assets/css/newshub.css">
</head>

<body>
    <!-- nagivation bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-transparent fixed-top">
        <div class="container">
            <div class="d-flex">
                <button class="navbar-toggler shadow-none border-0" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <a class="navbar-brand d-flex mx-3" href="#">
                    <div class="d-flex flex-column lh-1">
                        <p class="mb-0">Malaysian Cuisine</p>
                        <p class="mb-0 fs-6 fw-light">The Food Paradise</p>
                    </div>
                </a>
            </div>
            <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar"
                aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
                        <div class="d-flex flex-column lh-1">
                            <p class="mb-0">Malaysian Cuisine</p>
                            <p class="mb-0 fs-6 fw-light text-muted">The Food Paradise</p>
                        </div>
                    </h5>
                    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-center flex-grow-1">
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">Explore</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">Events</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link mx-2" href="#">About</a>
                        </li>
                    </ul>
                    <div class="d-flex justify-content-start align-items-center mx-2 mt-3 mt-lg-0 ">
                        <button type="button" class="btn-contact-us">Contact us</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div id="screen-loading">
        <div class="spinner-border text-danger" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>

    <!-- Malaysian Cuisine News -->
    <section id="malaysian-cuisine-news">
        <div class="jumbotron">
            <div class="container">
                <h1 class="text-center fw-bold mb-5">Malaysian Cuisine News</h1>
                <div class="row mb-5">
                    <div class="col-md-6 p-2">
                        <input type="text" id="search-input" class="form-control shadow-sm" placeholder="Search news">
                    </div>
                    <div class="col-md-3 p-2">
                        <select id="sort-order" class="form-select shadow-sm">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                        </select>
                    </div>
                    <div class="col-md-3 p-2">
                        <select id="category-filter" class="form-select shadow-sm">
                            <option value="all">All Categories</option>
                            <option value="cuisine">Cuisine</option>
                            <option value="restaurant">Restaurant</option>
                            <option value="food">Food</option>
                        </select>
                    </div>
                </div>
                <div class="select">
                    <div class="selected" data-default="All" data-one="option-1" data-two="option-2"
                        data-three="option-3">
                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512" class="arrow">
                            <path
                                d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z">
                            </path>
                        </svg>
                    </div>
                    <div class="options">
                        <div title="all">
                            <input id="all" name="option" type="radio" checked="" />
                            <label class="option" for="all" data-txt="All"></label>
                        </div>
                        <div title="option-1">
                            <input id="option-1" name="option" type="radio" />
                            <label class="option" for="option-1" data-txt="option-1"></label>
                        </div>
                        <div title="option-2">
                            <input id="option-2" name="option" type="radio" />
                            <label class="option" for="option-2" data-txt="option-2"></label>
                        </div>
                        <div title="option-3">
                            <input id="option-3" name="option" type="radio" />
                            <label class="option" for="option-3" data-txt="option-3"></label>
                        </div>
                    </div>
                </div>
                <div id="news-container" class="row"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black text-white pt-5 pb-1 px-3">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 pe-5 py-3">
                    <img src="" alt="Website Logo" class="img-fluid mb-3">
                    <p>We are dedicated to bringing you the best content about Malaysian cuisine and culture. Explore
                        our website for more insights and updates.</p>
                </div>
                <div class="col-lg-3 py-3">
                    <h5 class="mb-4">Quick Links</h5>
                    <ul class="list-unstyled">
                        <li class="mb-3"><a href="#" class="text-white text-decoration-none">Home</a></li>
                        <li class="mb-3"><a href="#" class="text-white text-decoration-none">Explore</a></li>
                        <li class="mb-3"><a href="#" class="text-white text-decoration-none">Event</a></li>
                        <li class="mb-3"><a href="#" class="text-white text-decoration-none">About</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 py-3">
                    <h5 class="mb-4">Contact Us</h5>
                    <p>Email: info@example.com</p>
                    <p>Phone: +123 456 7890</p>
                    <p>Address: 123 Street, City, Country</p>
                    <div class="d-flex mt-4">
                        <a href="#" class="icon-social-media rounded-circle text-center me-4">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="icon-social-media rounded-circle text-center me-4">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="icon-social-media rounded-circle text-center me-4">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-center p-3 mt-3">
                <p>&copy; 2024 Malaysian Cuisine The Food Paradise. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Back to top button -->
    <a href="#" class="btn-go-to-top"><i class="fas fa-chevron-up"></i></a>

    <!-- Bootstrap -->
    <script src="./assets/js/bootstrap.bundle.min.js"></script>

    <!-- Animation -->
    <script src="./assets/js/aos.js"></script>

    <!-- Layout -->
    <script src="./assets/js/layout.js"></script>

    <script>
        const apiKey = 'fd448bf94db043b48c2a3f0c228f8b0b';
        const newsContainer = document.getElementById('news-container');
        const searchInput = document.getElementById('search-input');
        const sortOrder = document.getElementById('sort-order');
        const categoryFilter = document.getElementById('category-filter');
        const screenLoading = document.getElementById('screen-loading');

        let allNews = [];
        async function fetchNews() {
            try {
                // const response = await fetch(`https://newsapi.org/v2/everything?apiKey=${apiKey}&q=Malaysian+cuisine+OR+Malaysian+restaurant+OR+Malaysian+food&language=en&pageSize=100`);

                // if (!response.ok) {
                //     throw new Error('Network response was not ok');
                // }

                // const data = await response.json();

                // let allNews = data.articles.filter(article =>
                //     article.title && article.description && article.url && article.urlToImage && article.publishedAt
                // );

                let allNews = JSON.stringify({
                    "source": {
                        "id": null,
                        "name": "The Star Online"
                    },
                    "author": "The Star Online",
                    "title": "Malaysian cuisine debuts in Auckland",
                    "description": "AUCKLAND: The Agriculture and Food Security Ministry made its debut at The Food Show in Auckland, New Zealand, which was held from July 25 to 28. Read full story",
                    "url": "https://www.thestar.com.my/news/nation/2024/08/02/malaysian-cuisine-debuts-in-auckland",
                    "urlToImage": "https://apicms.thestar.com.my/uploads/images/2024/08/02/2836278.jpg",
                    "publishedAt": "2024-08-02T03:01:00Z",
                    "content": "AUCKLAND: The Agriculture and Food Security Ministry made its debut at The Food Show in Auckland, New Zealand, which was held from July 25 to 28.\r\nMalaysian High Commissioner to New Zealand Mazita Ma… [+2691 chars]"
                });

                console.log(JSON.parse(allNews));

                displayNews(JSON.parse(allNews));
            } catch (error) {
                console.error('Error fetching news:', error);
            } finally {
                screenLoading.style.display = 'none';
            }
        }

        function displayNews(news) {
            newsContainer.innerHTML = '';
            // news.forEach(article => {
            //     const card = createNewsCard(article);
            //     newsContainer.appendChild(card);
            // });   
            const card = createNewsCard(news);
            newsContainer.appendChild(card);
        }

        function createNewsCard(article) {
            const card = document.createElement('div');
            card.className = 'col-md-12 mb-4';
            card.innerHTML =
                `<div class="card h-100 p-4">
                <a href="${article.url}" target="_blank" class="d-flex flex-column flex-md-row justify-content-between">
                    <div class="order-2 order-md-1 me-md-4">
                        <div class="d-flex flex-column justify-content-between h-100">
                            <div>
                                <h5 class="fw-bold">${article.title}</h5>
                                <p class="text-muted">${article.description}</p>
                            </div>
                            <div>
                                <small class="text-muted">${article.author}• ${formatPublishedDate(article.publishedAt)}</small>
                            </div>
                        </div>
                    </div>
                    <img src="${article.urlToImage || 'https://via.placeholder.com/300x200'}"
                         class="img-fluid fixed-size order-1 order-md-2 rounded-3 mb-3 mb-md-0"
                         alt="${article.title}">
                </a>
                </div>`;

            return card;
        }

        function filterNews() {
            const searchTerm = searchInput.value.toLowerCase();
            const category = categoryFilter.value;
            const sortByDate = sortOrder.value;

            let filteredNews = allNews.filter(article => {
                const matchesSearch = article.title.toLowerCase().includes(searchTerm) || article.description.toLowerCase().includes(searchTerm);
                const matchesCategory = category === 'all' || article.title.toLowerCase().includes(category);
                return matchesSearch && matchesCategory;
            });

            if (sortByDate === 'newest') {
                filteredNews.sort((a, b) => new Date(b.publishedAt) - new Date(a.publishedAt));
            } else {
                filteredNews.sort((a, b) => new Date(a.publishedAt) - new Date(b.publishedAt));
            }

            animateNewsCards(filteredNews);
        }

        function animateNewsCards(filteredNews) {
            const cards = document.querySelectorAll('.news-card');
            cards.forEach(card => {
                card.classList.add('filtered-out');
            });

            setTimeout(() => {
                displayNews(filteredNews);
                setTimeout(() => {
                    const newCards = document.querySelectorAll('.news-card');
                    newCards.forEach(card => {
                        card.classList.remove('filtered-out');
                    });
                }, 50);
            }, 300);
        }

        function formatPublishedDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-GB', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
        }

        searchInput.addEventListener('input', filterNews);
        sortOrder.addEventListener('change', filterNews);
        categoryFilter.addEventListener('change', filterNews);
        document.addEventListener('DOMContentLoaded', fetchNews)
    </script>
</body>

</html>